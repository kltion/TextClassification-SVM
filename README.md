# 文本分类 SVM 模型

基于CPU多核优化的文本分类SVM模型，专为大规模文本分类任务设计，能在有限内存环境下高效处理新闻分类任务。

## 项目简介

本项目实现了一个优化的SVM文本分类系统，针对新闻文本分类任务，使用TF-IDF特征提取和线性SVM分类器。系统经过内存和性能优化，能够在有限内存环境(16GB)下稳定处理大规模数据集，无内存溢出风险。

## 数据集

本项目使用阿里天池比赛"零基础入门NLP - 新闻文本分类"的数据集。由于数据集较大，未包含在代码仓库中。

### 数据集获取方式

1. 从阿里天池比赛官网下载：https://tianchi.aliyun.com/competition/entrance/531810/information
2. 下载后解压到项目的`input`目录
3. 确保`input`目录包含以下文件：
   - `train_set.csv` (训练集)
   - `test_a.csv` (测试集)

数据集格式为CSV（以Tab分隔），详细说明请查看`input/README.md`文件。

## 功能特点

- 多核CPU并行处理，充分利用计算资源
- 优化的内存管理，避免OOM (Out of Memory)错误
- 增量训练支持，批量处理大型数据集
- 自动内存监控和调整
- 完整的评估报告和可视化
- 标签分布自动对比分析

## 文件结构

- `advanced_svm.py` - 主要代码文件，包含SVM模型实现
- `run_cpu_optimized.sh` - 优化的执行脚本，设置环境和资源管理
- `input/` - 存放训练和测试数据的目录
- `output/` - 存放结果和模型的目录
- `requirements.txt` - 项目依赖库列表

## 优化策略

### 内存优化

- 分批加载和处理数据
- 稀疏矩阵表示特征
- 减少特征维度（仅使用25000维TF-IDF特征）
- 增量训练避免一次性加载全部数据
- 自动垃圾回收
- 使用float32替代float64
- 自动内存监控和限制

### 速度优化

- 23核CPU并行计算
- 批处理数据变换和预测
- 增量SVM训练（每次处理5000样本）
- 调整SVM参数加速收敛（增加容忍度，减少迭代次数）

## 使用方法

### 环境准备

```bash
# 创建虚拟环境
conda create -n svm_env python=3.8
conda activate svm_env

# 安装依赖
pip install -r requirements.txt
```

### 运行训练

```bash
# 运行优化的训练脚本
./run_cpu_optimized.sh
```

### 输出结果

- `output/svm_model.pkl` - 训练好的模型
- `output/submission.csv` - 预测结果文件
- `output/confusion_matrix.png` - 混淆矩阵
- `output/label_distribution.png` - 标签分布图
- `output/text_length_distribution.png` - 文本长度分布图

## 性能指标

基于实际运行结果：

- 训练集大小: 200,000条新闻文本（抽样至99,996条）
- 测试集大小: 50,000条新闻文本
- 内存峰值: 约1.5GB
- 训练耗时: 约40秒
- 验证集F1分数: 0.8982
- 验证集准确率: 92%
- 预测结果与训练集分布偏差: 平均±0.22%

### 各类别性能

```
              precision    recall  f1-score   support
           0       0.94      0.89      0.91      1946
           1       0.92      0.93      0.93      1847
           2       0.97      0.99      0.98      1571
           3       0.92      0.95      0.94      1107
           4       0.86      0.90      0.88       751
           5       0.81      0.88      0.84       612
           6       0.91      0.93      0.92       499
           7       0.85      0.77      0.81       442
           8       0.89      0.90      0.90       392
           9       0.89      0.88      0.89       294
          10       0.90      0.92      0.91       246
          11       0.90      0.85      0.87       157
          12       0.95      0.86      0.90        91
          13       0.95      0.84      0.89        45
```

## 贡献者

- KLtion

## 许可证

MIT License